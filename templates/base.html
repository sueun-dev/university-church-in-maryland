<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}University Church{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO Meta Tags -->
  <meta name="keywords" content="{% block meta_keywords %}{{ get_content('meta_default_keywords') }}{% endblock %}" />
  <meta name="description" content="{% block meta_description %}{{ get_content('meta_default_description') }}{% endblock %}" />

  <!-- Open Graph Meta Tags -->
  <meta property="og:image" content="https://images.squarespace-cdn.com/content/v1/6732bd65ccc0e358adb9002a/59243f07-253d-4cf4-b918-60bb34cb810b/ucmlogo.png%3Fformat=1500w" />

  <!-- Favicon -->
  <link href="https://images.squarespace-cdn.com/content/v1/6732bd65ccc0e358adb9002a/59243f07-253d-4cf4-b918-60bb34cb810b/ucmlogo.png%3Fformat=1500w" rel="icon" />

  <!-- External CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="/static/lib/animate/animate.min.css" rel="stylesheet" />
  <link href="/static/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />
  <link href="/static/css/bootstrap.min.css" rel="stylesheet" />
  <link href="/static/css/custom_styles.css" rel="stylesheet" />

  {% block css %}
  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    body { display: flex; flex-direction: column; }
    main { flex: 1 0 auto; }
    footer { flex-shrink: 0; }
  </style>
  {% endblock %}

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  
    <!-- 마크다운 콘텐츠 스타일 -->
  <style>
    .post-content {
      line-height: 1.6;
      word-break: break-word;
      overflow-wrap: break-word;
    }
    .post-content h1, .post-content h2, .post-content h3, .post-content h4, .post-content h5, .post-content h6 {
      margin-top: 1rem;
      margin-bottom: 0.8rem;
      font-weight: 600;
    }
    .post-content p {
      margin-bottom: 1rem;
    }
    .post-content ul, .post-content ol {
      margin-left: 1.5rem;
      margin-bottom: 1rem;
    }
    .post-content blockquote {
      border-left: 3px solid #ccc;
      padding-left: 1rem;
      margin-left: 0.5rem;
      color: #555;
    }
    .post-content pre {
      background-color: #f8f9fa;
      padding: 1rem;
      border-radius: 4px;
      overflow-x: auto;
    }
    .post-content code {
      background-color: #f8f9fa;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-family: monospace;
    }
    .post-content img {
      max-width: 100%;
      height: auto;
    }
    .post-content a {
      color: #0d6efd;
      text-decoration: underline;
    }
    .post-content table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    .post-content table th, .post-content table td {
      border: 1px solid #dee2e6;
      padding: 0.5rem;
    }
    .post-content table th {
      background-color: #f8f9fa;
    }
  </style>
</head>
  <body>
    <!-- Navbar Start -->
    <header>
      <div class="container-fluid nav-bar bg-transparent">
        <nav class="navbar navbar-expand-lg bg-white navbar-light py-0 px-4">
          <a href="{{ url_for('main.index') }}" class="navbar-brand d-flex align-items-center text-center">
            <div class="icon p-1 me-4">
              <img class="img-fluid" src="https://images.squarespace-cdn.com/content/v1/6732bd65ccc0e358adb9002a/59243f07-253d-4cf4-b918-60bb34cb810b/ucmlogo.png%3Fformat=1500w" alt="Church Logo" style="width: 50px; height: 50px;" />
            </div>
            <h1 class="m-0 text-primary" style="font-size: 18px;">{{ get_content('nav_brand_title', 'University Church') }}</h1>
          </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"><span class="navbar-toggler-icon"></span></button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto">
              <a href="{{ url_for('main.index') }}" class="nav-item nav-link {% if active_page == 'home' %}active{% endif %}">{{ get_content('nav_home_label', 'Home') }}</a>
              <a href="{{ url_for('main.about') }}" class="nav-item nav-link {% if active_page == 'about' %}active{% endif %}">{{ get_content('nav_about_label', '교회 소개') }}</a>
              <a href="{{ url_for('main.intro') }}" class="nav-item nav-link {% if active_page == 'intro' %}active{% endif %}">{{ get_content('nav_intro_label', '기독교 소개') }}</a>
              <a href="{{ url_for('main.sermons') }}" class="nav-item nav-link {% if active_page == 'sermons' %}active{% endif %}">{{ get_content('nav_sermons_label', '설교') }}</a>
              <a href="{{ url_for('main.bible_study') }}" class="nav-item nav-link {% if active_page == 'bible_study' %}active{% endif %}">{{ get_content('nav_bible_study_label', '성경 공부') }}</a>
              <a href="{{ url_for('main.church_life') }}" class="nav-item nav-link {% if active_page == 'church_life' %}active{% endif %}">{{ get_content('nav_church_life_label', '교회 생활') }}</a>
              <!-- FIXME! -->
              <!-- <a href="{{ url_for('main.read_posts') }}" class="nav-item nav-link {% if active_page == 'read' %}active{% endif %}">게시글</a> -->
              
              <!-- 게시글 링크 수정: read_posts 엔드포인트 사용 -->
              <!-- 자료공유 링크: upload_file 엔드포인트 사용 -->
              <a href="{{ url_for('main.upload_file') }}" class="nav-item nav-link {% if active_page == 'upload' %}active{% endif %}">{{ get_content('nav_resources_label', '자료공유') }}</a>
              {% if session.get('is_pastor') %}
                <a href="{{ url_for('main.manage_content') }}" class="nav-item nav-link {% if active_page == 'manage_content' %}active{% endif %}">
                  {{ get_content('nav_manage_content_label', '콘텐츠 관리') }}
                </a>
                <!-- 받은 메시지 메뉴 - 목사님만 볼 수 있음 -->
                <a href="{{ url_for('main.messages') }}" class="nav-item nav-link {% if active_page == 'messages' %}active{% endif %}">
                  {{ get_content('nav_messages_label', '받은 메시지') }}
                  {% if unread_count and unread_count > 0 %}
                  <span class="badge bg-danger">{{ unread_count }}</span>
                  {% endif %}
                </a>
                <a href="{{ url_for('main.logout') }}" class="nav-item nav-link">{{ get_content('nav_logout_label', 'Logout') }}</a>
              {% else %}
                <a href="{{ url_for('main.login', next=request.url) }}" class="nav-item nav-link">{{ get_content('nav_login_label', '관리자 로그인') }}</a>
              {% endif %}
              <a href="https://uchurchmd-org.translate.goog/?_x_tr_sl=auto&_x_tr_tl=en" class="btn btn-outline-success me-2">{{ get_content('nav_english_label', 'ENGLISH') }}</a>
              <a href="https://www.youtube.com/@uchurchmd" class="btn btn-outline-red me-2">{{ get_content('nav_youtube_label', 'UChurchMD TV') }}</a>
              <a href="https://universitychurchmd.org" class="btn btn-outline-primary" target="_blank">{{ get_content('nav_legacy_label', '이전 홈페이지') }}</a>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- Navbar End -->

    <!-- Main Content -->
    <main>
      {% block content %}

      {% endblock %}
    </main>

    <!-- Footer Start -->
    <footer class="container-fluid bg-dark text-white-50 footer pt-3 mt-3">
      <div class="container py-2">
        <div class="row g-5">
          <div class="col-lg-4">
            <h5>{{ get_content('footer_contact_heading', 'Get In Touch') }}</h5>
            <p><i class="fa fa-map-marker-alt me-3"></i>{{ get_content('footer_contact_address', '8108 54th Ave. College Park, MD 20740')|nl2br|safe }}</p>
          </div>
          <div class="col-lg-4">
            <h5>{{ get_content('footer_version_heading', 'Version Info') }}</h5>
            <p>{{ get_content('footer_version_text', 'Current Version: 1.0.0') }}</p>
            <div class="small">
              {{ get_content('footer_version_credit')|markdown }}
            </div>
          </div>
          <div class="col-lg-4">
            <h5>{{ get_content('footer_legal_heading', 'Legal') }}</h5>
            <p>{{ get_content('footer_legal_notice', 'Unauthorized use of content prohibited.') }}</p>
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer End -->

    <!-- External JS Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/static/lib/wow/wow.min.js"></script>
    <script src="/static/lib/easing/easing.min.js"></script>
    <script src="/static/lib/waypoints/waypoints.min.js"></script>
    <script src="/static/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="/static/js/main.js"></script>
    {% block scripts %}

    {% endblock %}
  </body>
</html>



